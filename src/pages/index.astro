---
import BaseLayout from "../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

// Fetch all published posts
const posts = (await getCollection("blog"))
  .filter(post => !post.data.draft)
  .sort((a, b) => b.data.pubDate - a.data.pubDate);

// Sections
const heroPost = posts[0];
const featuredPosts = posts.slice(1, 4);
const latestPosts = posts.slice(4, 14);
---

<BaseLayout
  title="AI, Automation & Technology Blog"
  description="Clear, practical guides on AI, automation, n8n workflows, productivity tools, and modern technology."
>
  <main class="container">

    <!-- HERO ARTICLE -->
    {heroPost && (
      <section>
        <h1>{heroPost.data.title}</h1>
        <p>{heroPost.data.description}</p>
        <p>
          <a href={`/blog/${heroPost.slug}/`}>
            Read full article â†’
          </a>
        </p>
      </section>
    )}

    <!-- FEATURED ARTICLES -->
    {featuredPosts.length > 0 && (
      <section>
        <h2>Featured Articles</h2>
        <ul>
          {featuredPosts.map(post => (
            <li>
              <a href={`/blog/${post.slug}/`}>
                <strong>{post.data.title}</strong>
              </a>
              <p>{post.data.description}</p>
            </li>
          ))}
        </ul>
      </section>
    )}

    <!-- LATEST ARTICLES -->
    <section>
      <h2>Latest Articles</h2>
      <ul>
        {latestPosts.map(post => (
          <li>
            <a href={`/blog/${post.slug}/`}>
              {post.data.title}
            </a>
          </li>
        ))}
      </ul>
    </section>

    <!-- TRUST / EDITORIAL -->
    <section>
      <h2>About This Blog</h2>
      <p>
        This website publishes educational and informational content focused on
        artificial intelligence, automation, and technology. Articles are written
        to be clear, practical, and useful for real-world applications.
      </p>
    </section>

  </main>
</BaseLayout>
