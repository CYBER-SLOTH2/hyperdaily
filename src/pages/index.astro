---
import BaseLayout from "../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

// Fetch published posts
const posts = (await getCollection("blog"))
  .filter(post => !post.data.draft)
  .sort((a, b) => b.data.pubDate - a.data.pubDate);

// Sections
const heroPost = posts[0];
const featuredPosts = posts.slice(1, 4);
const latestPosts = posts.slice(4, 14);
---

<BaseLayout
  title="AI, Automation & Technology Magazine"
  description="Latest guides, tutorials, and insights on AI, automation, productivity tools, and modern technology."
>
  <main class="container">

    <!-- HERO STORY -->
    {heroPost && (
      <section>
        <h1>
          <a href={`/blog/${heroPost.slug}/`}>
            {heroPost.data.title}
          </a>
        </h1>

        <p>{heroPost.data.description}</p>

        <p>
          <a href={`/blog/${heroPost.slug}/`}>
            Read full article â†’
          </a>
        </p>
      </section>
    )}

    <!-- FEATURED STORIES -->
    {featuredPosts.length > 0 && (
      <section>
        <h2>Featured</h2>
        <ul>
          {featuredPosts.map(post => (
            <li>
              <a href={`/blog/${post.slug}/`}>
                <strong>{post.data.title}</strong>
              </a>
              <p>{post.data.description}</p>
            </li>
          ))}
        </ul>
      </section>
    )}

    <!-- ADSENSE SAFE SLOT (ENABLE ONLY AFTER APPROVAL) -->
    {/*
    <AdSlot />
    */}

    <!-- LATEST ARTICLES -->
    <section>
      <h2>Latest Articles</h2>
      <ul>
        {latestPosts.map(post => (
          <li>
            <a href={`/blog/${post.slug}/`}>
              {post.data.title}
            </a>
          </li>
        ))}
      </ul>
    </section>

    <!-- EDITORIAL / TRUST -->
    <section>
      <h2>Editorial Policy</h2>
      <p>
        This publication focuses on educational and informational content related
        to artificial intelligence, automation, and technology. Articles are
        written to be clear, practical, and useful for real-world applications.
      </p>
    </section>

  </main>
</BaseLayout>
